<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Ferramenta de avalia√ß√£o de riscos psicossociais no ambiente de trabalho">
  <meta name="keywords" content="riscos psicossociais, COPSOQ, HSE, NIOSH, NR-01, NR-17">
  <title>Avalia√ß√£o de Riscos Psicossociais</title>
  <style>
    :root {
      --primary-color: #1565c0;
      --secondary-color: #42a5f5;
      --danger-color: #ef5350;
      --success-color: #4caf50;
      --warning-color: #ff9800;
      --background-gradient: linear-gradient(135deg, #e3f2fd 0%, #ffffff 100%);
      --card-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      --border-radius: 12px;
      --transition: all 0.3s ease;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: var(--background-gradient);
      min-height: 100vh;
      padding: 20px;
      line-height: 1.6;
    }

    .container {
      max-width: 800px;
      margin: 0 auto;
    }

    .header {
      text-align: center;
      margin-bottom: 30px;
    }

    .header h1 {
      color: var(--primary-color);
      font-size: 2.5rem;
      margin-bottom: 10px;
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .header p {
      color: #666;
      font-size: 1.1rem;
    }

    .card {
      background: white;
      border-radius: var(--border-radius);
      box-shadow: var(--card-shadow);
      padding: 30px;
      margin-bottom: 20px;
      transition: var(--transition);
    }

    .card:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15);
    }

    .methodology-selector {
      margin-bottom: 30px;
    }

    .methodology-selector label {
      display: block;
      margin-bottom: 10px;
      font-weight: 600;
      color: var(--primary-color);
    }

    select, button {
      width: 100%;
      padding: 15px;
      border: 2px solid #e0e0e0;
      border-radius: var(--border-radius);
      font-size: 16px;
      transition: var(--transition);
      background: white;
    }

    select:focus, button:focus {
      outline: none;
      border-color: var(--secondary-color);
      box-shadow: 0 0 0 3px rgba(66, 165, 245, 0.2);
    }

    select:hover {
      border-color: var(--secondary-color);
    }

    .questionario {
      display: none;
      animation: fadeIn 0.5s ease-in;
    }

    .questionario.active {
      display: block;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .questionario h2 {
      color: var(--primary-color);
      margin-bottom: 25px;
      font-size: 1.8rem;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .questionnaire-info {
      color: #666;
      margin-bottom: 20px;
      font-style: italic;
    }

    .question-group {
      margin-bottom: 20px;
      padding: 20px;
      background: #f8f9fa;
      border-radius: 8px;
      border-left: 4px solid var(--secondary-color);
    }

    .question-title {
      font-weight: 600;
      font-size: 1.1rem;
      margin-bottom: 15px;
      color: var(--primary-color);
    }

    .radio-group {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-top: 10px;
    }

    .radio-option {
      display: flex;
      align-items: center;
      padding: 12px 15px;
      background: white;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      cursor: pointer;
      transition: var(--transition);
      margin-bottom: 0;
    }

    .radio-option:hover {
      border-color: var(--secondary-color);
      background: #f8f9fa;
      transform: translateX(5px);
    }

    .radio-option input[type="radio"] {
      margin-right: 12px;
      width: 18px;
      height: 18px;
      cursor: pointer;
    }

    .radio-option input[type="radio"]:checked + .radio-text {
      color: var(--primary-color);
      font-weight: 600;
    }

    .radio-option:has(input[type="radio"]:checked) {
      border-color: var(--primary-color);
      background: rgba(21, 101, 192, 0.05);
      box-shadow: 0 2px 8px rgba(21, 101, 192, 0.1);
    }

    .radio-text {
      font-size: 16px;
      color: #333;
      flex: 1;
      line-height: 1.4;
    }

    .btn {
      background: var(--primary-color);
      color: white;
      border: none;
      padding: 15px 30px;
      border-radius: var(--border-radius);
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .btn:hover {
      background: #0d47a1;
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(21, 101, 192, 0.3);
    }

    .btn:active {
      transform: translateY(0);
    }

    .btn:disabled {
      background: #ccc;
      cursor: not-allowed;
      transform: none;
    }

    .version-selector {
      margin-bottom: 30px;
      display: none;
    }

    .version-options {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-top: 20px;
    }

    .version-option {
      cursor: pointer;
      margin: 0;
    }

    .version-option input[type="radio"] {
      display: none;
    }

    .version-card {
      padding: 20px;
      border: 2px solid #e0e0e0;
      border-radius: var(--border-radius);
      background: white;
      transition: var(--transition);
      text-align: center;
      height: 100%;
    }

    .version-card h4 {
      color: var(--primary-color);
      margin-bottom: 10px;
      font-size: 1.2rem;
    }

    .version-card p {
      margin: 5px 0;
      font-size: 0.9rem;
    }

    .version-option input[type="radio"]:checked + .version-card {
      border-color: var(--primary-color);
      background: rgba(21, 101, 192, 0.05);
      box-shadow: 0 4px 15px rgba(21, 101, 192, 0.2);
    }

    .version-card:hover {
      border-color: var(--secondary-color);
      transform: translateY(-2px);
    }

    .progress-bar {
      width: 100%;
      height: 10px;
      background: #e0e0e0;
      border-radius: 5px;
      overflow: hidden;
      margin: 20px 0;
    }

    .progress-fill {
      height: 100%;
      background: var(--secondary-color);
      transition: width 0.3s ease;
      width: 0%;
    }

    #dashboard {
      display: none;
    }

    #dashboard.active {
      display: block;
      animation: fadeIn 0.5s ease-in;
    }

    .dashboard-header {
      text-align: center;
      margin-bottom: 30px;
    }

    .dashboard-header h2 {
      color: var(--primary-color);
      font-size: 2rem;
      margin-bottom: 10px;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .stat-card {
      background: white;
      padding: 20px;
      border-radius: var(--border-radius);
      box-shadow: var(--card-shadow);
      text-align: center;
      border-top: 4px solid var(--secondary-color);
    }

    .stat-number {
      font-size: 2.5rem;
      font-weight: bold;
      color: var(--primary-color);
      margin-bottom: 5px;
    }

    .stat-label {
      color: #666;
      font-weight: 500;
    }

    .chart-container {
      position: relative;
      height: 400px;
      margin-top: 20px;
    }

    .recommendations {
      margin-top: 30px;
      padding: 20px;
      background: #f8f9fa;
      border-radius: var(--border-radius);
      border-left: 4px solid var(--warning-color);
    }

    .recommendations h3 {
      color: var(--primary-color);
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .recommendations ul {
      list-style: none;
      padding: 0;
    }

    .recommendations li {
      padding: 10px 0;
      border-bottom: 1px solid #e0e0e0;
    }

    .recommendations li:last-child {
      border-bottom: none;
    }

    .recommendations li::before {
      content: "üí°";
      margin-right: 10px;
    }

    .export-btn {
      background: var(--success-color);
      margin-top: 20px;
    }

    .export-btn:hover {
      background: #388e3c;
    }

    .reset-btn {
      background: var(--danger-color);
      margin-left: 10px;
    }

    .reset-btn:hover {
      background: #d32f2f;
    }

    @media (max-width: 768px) {
      .container {
        padding: 0 10px;
      }
      
      .header h1 {
        font-size: 2rem;
      }
      
      .card {
        padding: 20px;
      }
      
      .stats-grid {
        grid-template-columns: 1fr;
      }
      
      .btn {
        padding: 12px 20px;
        font-size: 14px;
      }
      
      .radio-option {
        padding: 10px 12px;
      }
      
      .radio-text {
        font-size: 14px;
      }
      
      .question-title {
        font-size: 1rem;
      }
      
      .version-options {
        grid-template-columns: 1fr;
      }
    }

    @media (max-width: 480px) {
      body {
        padding: 10px;
      }
      
      .header h1 {
        font-size: 1.5rem;
      }
      
      .card {
        padding: 15px;
      }
      
      .radio-option {
        padding: 8px 10px;
      }
      
      .radio-text {
        font-size: 13px;
      }
      
      .question-title {
        font-size: 0.9rem;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header class="header">
      <h1>üß† Avalia√ß√£o de Riscos Psicossociais</h1>
      <p>Ferramenta completa para an√°lise do ambiente de trabalho</p>
    </header>

    <main>
      <div class="card methodology-selector">
        <label for="metodologia">Escolha a metodologia de avalia√ß√£o:</label>
        <select id="metodologia" onchange="mostrarQuestionario()" aria-label="Selecionar metodologia">
          <option value="">-- Selecione uma metodologia --</option>
          <option value="copsoq">üß† COPSOQ III Short - Question√°rio Psicossocial</option>
          <option value="hse">üìä HSE Indicator Tool - Indicadores de Estresse</option>
          <option value="niosh">üè• NIOSH WellBQ - Bem-estar no Trabalho</option>
          <option value="nr">üìã NR-01 e NR-17 - Normas Regulamentadoras</option>
        </select>
        
        <div id="metodologia-info" class="methodology-info" style="display: none;">
          <p id="metodologia-descricao"></p>
        </div>
      </div>

      <div id="version-selector" class="card version-selector">
        <label>Escolha o tipo de avalia√ß√£o:</label>
        <div class="version-options">
          <label class="version-option">
            <input type="radio" name="version_type" value="rapida" onchange="updateVersionInfo()">
            <div class="version-card">
              <h4>‚ö° Triagem R√°pida</h4>
              <p><strong>5-6 quest√µes</strong></p>
              <p>Avalia√ß√£o inicial e r√°pida</p>
              <p>Tempo: 3-5 minutos</p>
            </div>
          </label>
          <label class="version-option">
            <input type="radio" name="version_type" value="completa" onchange="updateVersionInfo()">
            <div class="version-card">
              <h4>üìã Avalia√ß√£o Completa</h4>
              <p><strong>18-24 quest√µes</strong></p>
              <p>An√°lise detalhada e abrangente</p>
              <p>Tempo: 10-15 minutos</p>
            </div>
          </label>
        </div>
      </div>

      <div class="progress-bar" id="progress-container" style="display: none;">
        <div class="progress-fill" id="progress-fill"></div>
      </div>

      <!-- COPSOQ III Short - Vers√£o R√°pida -->
      <div id="copsoq-rapida" class="questionario card">
        <h2>üß† COPSOQ III Short - Triagem R√°pida</h2>
        <p class="questionnaire-info">5 quest√µes essenciais baseadas no question√°rio oficial internacional</p>
        
        <div class="question-group">
          <label class="question-title">1. Com que frequ√™ncia voc√™ n√£o tem tempo suficiente para completar todas as suas tarefas de trabalho?</label>
          <div class="radio-group">
            <label class="radio-option">
              <input type="radio" name="copsoq_q1" value="4" onchange="updateProgress()">
              <span class="radio-text">Sempre</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="copsoq_q1" value="3" onchange="updateProgress()">
              <span class="radio-text">Frequentemente</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="copsoq_q1" value="2" onchange="updateProgress()">
              <span class="radio-text">√Äs vezes</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="copsoq_q1" value="1" onchange="updateProgress()">
              <span class="radio-text">Raramente</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="copsoq_q1" value="0" onchange="updateProgress()">
              <span class="radio-text">Nunca</span>
            </label>
          </div>
        </div>

        <div class="question-group">
          <label class="question-title">2. Voc√™ tem um alto grau de influ√™ncia nas decis√µes relacionadas ao seu trabalho?</label>
          <div class="radio-group">
            <label class="radio-option">
              <input type="radio" name="copsoq_q2" value="4" onchange="updateProgress()">
              <span class="radio-text">Em grande medida</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="copsoq_q2" value="3" onchange="updateProgress()">
              <span class="radio-text">Em boa medida</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="copsoq_q2" value="2" onchange="updateProgress()">
              <span class="radio-text">De alguma forma</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="copsoq_q2" value="1" onchange="updateProgress()">
              <span class="radio-text">Em pequena medida</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="copsoq_q2" value="0" onchange="updateProgress()">
              <span class="radio-text">Muito pouco</span>
            </label>
          </div>
        </div>

        <div class="question-group">
          <label class="question-title">3. Com que frequ√™ncia voc√™ recebe ajuda e apoio do seu supervisor imediato, quando necess√°rio?</label>
          <div class="radio-group">
            <label class="radio-option">
              <input type="radio" name="copsoq_q3" value="4" onchange="updateProgress()">
              <span class="radio-text">Sempre</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="copsoq_q3" value="3" onchange="updateProgress()">
              <span class="radio-text">Frequentemente</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="copsoq_q3" value="2" onchange="updateProgress()">
              <span class="radio-text">√Äs vezes</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="copsoq_q3" value="1" onchange="updateProgress()">
              <span class="radio-text">Raramente</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="copsoq_q3" value="0" onchange="updateProgress()">
              <span class="radio-text">Nunca</span>
            </label>
          </div>
        </div>

        <div class="question-group">
          <label class="question-title">4. Com que frequ√™ncia voc√™ recebe ajuda e apoio dos seus colegas, quando necess√°rio?</label>
          <div class="radio-group">
            <label class="radio-option">
              <input type="radio" name="copsoq_q4" value="4" onchange="updateProgress()">
              <span class="radio-text">Sempre</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="copsoq_q4" value="3" onchange="updateProgress()">
              <span class="radio-text">Frequentemente</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="copsoq_q4" value="2" onchange="updateProgress()">
              <span class="radio-text">√Äs vezes</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="copsoq_q4" value="1" onchange="updateProgress()">
              <span class="radio-text">Raramente</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="copsoq_q4" value="0" onchange="updateProgress()">
              <span class="radio-text">Nunca</span>
            </label>
          </div>
        </div>

        <div class="question-group">
          <label class="question-title">5. Seu trabalho √© significativo para voc√™?</label>
          <div class="radio-group">
            <label class="radio-option">
              <input type="radio" name="copsoq_q5" value="4" onchange="updateProgress()">
              <span class="radio-text">Em grande medida</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="copsoq_q5" value="3" onchange="updateProgress()">
              <span class="radio-text">Em boa medida</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="copsoq_q5" value="2" onchange="updateProgress()">
              <span class="radio-text">De alguma forma</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="copsoq_q5" value="1" onchange="updateProgress()">
              <span class="radio-text">Em pequena medida</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="copsoq_q5" value="0" onchange="updateProgress()">
              <span class="radio-text">Muito pouco</span>
            </label>
          </div>
        </div>

        <button class="btn" onclick="calcularResultados('copsoq-rapida')">Calcular Resultados</button>
      </div>

      <!-- HSE Indicator Tool - Vers√£o R√°pida -->
      <div id="hse-rapida" class="questionario card">
        <h2>üìä HSE Indicator Tool - Triagem R√°pida</h2>
        <p class="questionnaire-info">6 quest√µes essenciais (1 por dom√≠nio) baseadas no question√°rio oficial brit√¢nico</p>
        
        <div class="question-group">
          <label class="question-title">1. [DEMANDS] Eu tenho prazos irreais para cumprir</label>
          <div class="radio-group">
            <label class="radio-option">
              <input type="radio" name="hse_q1" value="0" onchange="updateProgress()">
              <span class="radio-text">Sempre</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="hse_q1" value="1" onchange="updateProgress()">
              <span class="radio-text">Frequentemente</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="hse_q1" value="2" onchange="updateProgress()">
              <span class="radio-text">√Äs vezes</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="hse_q1" value="3" onchange="updateProgress()">
              <span class="radio-text">Raramente</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="hse_q1" value="4" onchange="updateProgress()">
              <span class="radio-text">Nunca</span>
            </label>
          </div>
        </div>

        <div class="question-group">
          <label class="question-title">2. [CONTROL] Eu posso decidir quando fazer uma pausa</label>
          <div class="radio-group">
            <label class="radio-option">
              <input type="radio" name="hse_q2" value="4" onchange="updateProgress()">
              <span class="radio-text">Sempre</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="hse_q2" value="3" onchange="updateProgress()">
              <span class="radio-text">Frequentemente</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="hse_q2" value="2" onchange="updateProgress()">
              <span class="radio-text">√Äs vezes</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="hse_q2" value="1" onchange="updateProgress()">
              <span class="radio-text">Raramente</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="hse_q2" value="0" onchange="updateProgress()">
              <span class="radio-text">Nunca</span>
            </label>
          </div>
        </div>

        <div class="question-group">
          <label class="question-title">3. [SUPPORT] Se o trabalho ficar dif√≠cil, meus colegas me ajudam</label>
          <div class="radio-group">
            <label class="radio-option">
              <input type="radio" name="hse_q3" value="4" onchange="updateProgress()">
              <span class="radio-text">Sempre</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="hse_q3" value="3" onchange="updateProgress()">
              <span class="radio-text">Frequentemente</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="hse_q3" value="2" onchange="updateProgress()">
              <span class="radio-text">√Äs vezes</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="hse_q3" value="1" onchange="updateProgress()">
              <span class="radio-text">Raramente</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="hse_q3" value="0" onchange="updateProgress()">
              <span class="radio-text">Nunca</span>
            </label>
          </div>
        </div>

        <div class="question-group">
          <label class="question-title">4. [RELATIONSHIPS] Existe tens√£o ou raiva entre os colegas</label>
          <div class="radio-group">
            <label class="radio-option">
              <input type="radio" name="hse_q4" value="0" onchange="updateProgress()">
              <span class="radio-text">Sempre</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="hse_q4" value="1" onchange="updateProgress()">
              <span class="radio-text">Frequentemente</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="hse_q4" value="2" onchange="updateProgress()">
              <span class="radio-text">√Äs vezes</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="hse_q4" value="3" onchange="updateProgress()">
              <span class="radio-text">Raramente</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="hse_q4" value="4" onchange="updateProgress()">
              <span class="radio-text">Nunca</span>
            </label>
          </div>
        </div>

        <div class="question-group">
          <label class="question-title">5. [ROLE] Est√° claro para mim quais s√£o meus deveres e responsabilidades</label>
          <div class="radio-group">
            <label class="radio-option">
              <input type="radio" name="hse_q5" value="4" onchange="updateProgress()">
              <span class="radio-text">Concordo totalmente</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="hse_q5" value="3" onchange="updateProgress()">
              <span class="radio-text">Concordo</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="hse_q5" value="2" onchange="updateProgress()">
              <span class="radio-text">Neutro</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="hse_q5" value="1" onchange="updateProgress()">
              <span class="radio-text">Discordo</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="hse_q5" value="0" onchange="updateProgress()">
              <span class="radio-text">Discordo totalmente</span>
            </label>
          </div>
        </div>

        <div class="question-group">
          <label class="question-title">6. [CHANGE] Quando mudan√ßas s√£o feitas no trabalho, fica claro como funcionar√£o na
 pr√°tica</label>
          <div class="radio-group">
            <label class="radio-option">
              <input type="radio" name="hse_q6" value="4" onchange="updateProgress()">
              <span class="radio-text">Concordo totalmente</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="hse_q6" value="3" onchange="updateProgress()">
              <span class="radio-text">Concordo</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="hse_q6" value="2" onchange="updateProgress()">
              <span class="radio-text">Neutro</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="hse_q6" value="1" onchange="updateProgress()">
              <span class="radio-text">Discordo</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="hse_q6" value="0" onchange="updateProgress()">
              <span class="radio-text">Discordo totalmente</span>
            </label>
          </div>
        </div>

        <button class="btn" onclick="calcularResultados('hse-rapida')">Calcular Resultados</button>
      </div>

      <!-- Dashboard de Resultados -->
      <div id="dashboard" class="card">
        <div class="dashboard-header">
          <h2>üìä Resultados da Avalia√ß√£o</h2>
          <p id="dashboard-subtitle"></p>
        </div>

        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-number" id="stat-score">0</div>
            <div class="stat-label">Pontua√ß√£o Total</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="stat-percentage">0%</div>
            <div class="stat-label">Percentual</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="stat-level">-</div>
            <div class="stat-label">N√≠vel de Risco</div>
          </div>
        </div>

        <div class="chart-container">
          <canvas id="resultsChart"></canvas>
        </div>

        <div class="recommendations">
          <h3>üí° Recomenda√ß√µes</h3>
          <ul id="recommendations-list"></ul>
        </div>

        <div style="display: flex; gap: 10px; margin-top: 20px;">
          <button class="btn export-btn" onclick="exportarResultados()">üì• Exportar Relat√≥rio</button>
          <button class="btn reset-btn" onclick="resetarAvaliacao()">üîÑ Nova Avalia√ß√£o</button>
        </div>
      </div>
    </main>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    let currentMethodology = '';
    let currentVersion = '';
    let chartInstance = null;

    function mostrarQuestionario() {
      const metodologia = document.getElementById('metodologia').value;
      currentMethodology = metodologia;
      
      // Esconder todos os question√°rios
      document.querySelectorAll('.questionario').forEach(q => {
        q.classList.remove('active');
      });
      
      // Esconder dashboard
      document.getElementById('dashboard').classList.remove('active');
      
      // Resetar sele√ß√£o de vers√£o
      document.querySelectorAll('input[name="version_type"]').forEach(input => {
        input.checked = false;
      });
      
      if (metodologia) {
        // Mostrar seletor de vers√£o
        document.getElementById('version-selector').style.display = 'block';
        
        // Atualizar descri√ß√£o da metodologia
        const descricoes = {
          'copsoq': 'O COPSOQ III (Copenhagen Psychosocial Questionnaire) √© um instrumento internacional validado para avaliar riscos psicossociais no trabalho.',
          'hse': 'O HSE Indicator Tool √© desenvolvido pelo Health and Safety Executive do Reino Unido para avaliar seis √°reas-chave de estresse no trabalho.',
          'niosh': 'O NIOSH WellBQ avalia o bem-estar no trabalho atrav√©s de m√∫ltiplas dimens√µes da sa√∫de ocupacional.',
          'nr': 'Avalia√ß√£o baseada nas Normas Regulamentadoras brasileiras NR-01 (Gerenciamento de Riscos) e NR-17 (Ergonomia).'
        };
        
        document.getElementById('metodologia-info').style.display = 'block';
        document.getElementById('metodologia-descricao').textContent = descricoes[metodologia];
      } else {
        document.getElementById('version-selector').style.display = 'none';
        document.getElementById('metodologia-info').style.display = 'none';
        document.getElementById('progress-container').style.display = 'none';
      }
    }

    function updateVersionInfo() {
      const versionType = document.querySelector('input[name="version_type"]:checked');
      
      if (versionType && currentMethodology) {
        const questionarioId = `${currentMethodology}-${versionType.value}`;
        
        // Esconder todos os question√°rios
        document.querySelectorAll('.questionario').forEach(q => {
          q.classList.remove('active');
        });
        
        // Mostrar question√°rio selecionado
        const questionario = document.getElementById(questionarioId);
        if (questionario) {
          questionario.classList.add('active');
          document.getElementById('progress-container').style.display = 'block';
          currentVersion = versionType.value;
          updateProgress();
          
          // Scroll suave para o question√°rio
          setTimeout(() => {
            questionario.scrollIntoView({ behavior: 'smooth', block: 'start' });
          }, 100);
        }
      }
    }

    function updateProgress() {
      if (!currentMethodology || !currentVersion) return;
      
      const questionarioId = `${currentMethodology}-${currentVersion}`;
      const questionario = document.getElementById(questionarioId);
      
      if (!questionario) return;
      
      const totalQuestions = questionario.querySelectorAll('.question-group').length;
      const answeredQuestions = questionario.querySelectorAll('input[type="radio"]:checked').length;
      
      const progress = (answeredQuestions / totalQuestions) * 100;
      document.getElementById('progress-fill').style.width = progress + '%';
      
      // Habilitar bot√£o de calcular se todas as quest√µes foram respondidas
      const calcButton = questionario.querySelector('.btn');
      if (calcButton) {
        calcButton.disabled = answeredQuestions < totalQuestions;
      }
    }

    function calcularResultados(questionarioId) {
      const questionario = document.getElementById(questionarioId);
      const inputs = questionario.querySelectorAll('input[type="radio"]:checked');
      
      let totalScore = 0;
      let maxScore = 0;
      
      inputs.forEach(input => {
        totalScore += parseInt(input.value);
      });
      
      // Calcular pontua√ß√£o m√°xima baseada no n√∫mero de quest√µes
      const totalQuestions = questionario.querySelectorAll('.question-group').length;
      maxScore = totalQuestions * 4; // Assumindo escala de 0-4
      
      const percentage = (totalScore / maxScore) * 100;
      
      // Determinar n√≠vel de risco
      let riskLevel = '';
      let riskColor = '';
      
      if (percentage >= 75) {
        riskLevel = 'Baixo';
        riskColor = 'var(--success-color)';
      } else if (percentage >= 50) {
        riskLevel = 'Moderado';
        riskColor = 'var(--warning-color)';
      } else if (percentage >= 25) {
        riskLevel = 'Alto';
        riskColor = 'var(--danger-color)';
      } else {
        riskLevel = 'Cr√≠tico';
        riskColor = '#c62828';
      }
      
      // Atualizar dashboard
      document.getElementById('stat-score').textContent = totalScore;
      document.getElementById('stat-percentage').textContent = percentage.toFixed(1) + '%';
      document.getElementById('stat-level').textContent = riskLevel;
      document.getElementById('stat-level').style.color = riskColor;
      
      const metodologiaNames = {
        'copsoq': 'COPSOQ III Short',
        'hse': 'HSE Indicator Tool',
        'niosh': 'NIOSH WellBQ',
        'nr': 'NR-01 e NR-17'
      };
      
      document.getElementById('dashboard-subtitle').textContent = 
        `Metodologia: ${metodologiaNames[currentMethodology]} - ${currentVersion === 'rapida' ? 'Triagem R√°pida' : 'Avalia√ß√£o Completa'}`;
      
      // Gerar recomenda√ß√µes
      gerarRecomendacoes(riskLevel, currentMethodology);
      
      // Criar gr√°fico
      criarGrafico(totalScore, maxScore, riskLevel);
      
      // Mostrar dashboard
      document.getElementById('dashboard').classList.add('active');
      
      // Esconder question√°rio
      questionario.classList.remove('active');
      
      // Scroll para dashboard
      setTimeout(() => {
        document.getElementById('dashboard').scrollIntoView({ behavior: 'smooth', block: 'start' });
      }, 100);
    }

    function gerarRecomendacoes(riskLevel, methodology) {
      const recommendationsList = document.getElementById('recommendations-list');
      recommendationsList.innerHTML = '';
      
      const recomendacoes = {
        'Baixo': [
          'Manter as pr√°ticas atuais de gest√£o de riscos psicossociais',
          'Realizar avalia√ß√µes peri√≥dicas para monitoramento cont√≠nuo',
          'Compartilhar boas pr√°ticas com outras √°reas da organiza√ß√£o',
          'Considerar programas de reconhecimento e valoriza√ß√£o dos colaboradores'
        ],
        'Moderado': [
          'Implementar a√ß√µes preventivas para evitar agravamento dos riscos',
          'Realizar reuni√µes regulares de feedback com a equipe',
          'Revisar processos de trabalho e distribui√ß√£o de demandas',
          'Oferecer treinamentos sobre gest√£o de estresse e bem-estar',
          'Estabelecer canais de comunica√ß√£o mais efetivos'
        ],
        'Alto': [
          'A√ß√£o imediata necess√°ria para redu√ß√£o dos riscos identificados',
          'Realizar diagn√≥stico detalhado com avalia√ß√£o completa',
          'Implementar programa estruturado de gest√£o de riscos psicossociais',
          'Oferecer suporte psicol√≥gico aos colaboradores',
          'Revisar carga de trabalho e prazos',
          'Melhorar comunica√ß√£o e apoio da lideran√ßa'
        ],
        'Cr√≠tico': [
          'ATEN√á√ÉO: Situa√ß√£o cr√≠tica requer interven√ß√£o urgente',
          'Realizar avalia√ß√£o completa imediatamente',
          'Implementar medidas emergenciais de prote√ß√£o',
          'Disponibilizar suporte psicol√≥gico profissional',
          'Revisar completamente a organiza√ß√£o do trabalho',
          'Envolver alta gest√£o e recursos humanos',
          'Considerar afastamento tempor√°rio de colaboradores em risco',
          'Desenvolver plano de a√ß√£o detalhado com prazos definidos'
        ]
      };
      
      const lista = recomendacoes[riskLevel] || [];
      lista.forEach(rec => {
        const li = document.createElement('li');
        li.textContent = rec;
        recommendationsList.appendChild(li);
      });
    }

    function criarGrafico(score, maxScore, riskLevel) {
      const ctx = document.getElementById('resultsChart').getContext('2d');
      
      // Destruir gr√°fico anterior se existir
      if (chartInstance) {
        chartInstance.destroy();
      }
      
      const percentage = (score / maxScore) * 100;
      const remaining = 100 - percentage;
      
      let backgroundColor = '';
      if (riskLevel === 'Baixo') backgroundColor = 'rgba(76, 175, 80, 0.8)';
      else if (riskLevel === 'Moderado') backgroundColor = 'rgba(255, 152, 0, 0.8)';
      else if (riskLevel === 'Alto') backgroundColor = 'rgba(239, 83, 80, 0.8)';
      else backgroundColor = 'rgba(198, 40, 40, 0.8)';
      
      chartInstance = new Chart(ctx, {
        type: 'doughnut',
        data: {
          labels: ['Pontua√ß√£o Obtida', 'Pontua√ß√£o Restante'],
          datasets: [{
            data: [percentage, remaining],
            backgroundColor: [backgroundColor, 'rgba(224, 224, 224, 0.5)'],
            borderWidth: 2,
            borderColor: '#fff'
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              position: 'bottom',
              labels: {
                padding: 20,
                font: {
                  size: 14
                }
              }
            },
            title: {
              display: true,
              text: `N√≠vel de Risco: ${riskLevel}`,
              font: {
                size: 18,
                weight: 'bold'
              },
              padding: 20
            },
            tooltip: {
              callbacks: {
                label: function(context) {
                  return context.label + ': ' + context.parsed.toFixed(1) + '%';
                }
              }
            }
          }
        }
      });
    }

    function exportarResultados() {
      const score = document.getElementById('stat-score').textContent;
      const percentage = document.getElementById('stat-percentage').textContent;
      const level = document.getElementById('stat-level').textContent;
      const subtitle = document.getElementById('dashboard-subtitle').textContent;
      
      const recommendations = [];
      document.querySelectorAll('#recommendations-list li').forEach(li => {
        recommendations.push(li.textContent);
      });
      
      const reportContent = `
RELAT√ìRIO DE AVALIA√á√ÉO DE RISCOS PSICOSSOCIAIS
=============================================

${subtitle}
Data: ${new Date().toLocaleDateString('pt-BR')}

RESULTADOS
----------
Pontua√ß√£o Total: ${score}
Percentual: ${percentage}
N√≠vel de Risco: ${level}

RECOMENDA√á√ïES
-------------
${recommendations.map((rec, i) => `${i + 1}. ${rec}`).join('\n')}

---
Relat√≥rio gerado pela Ferramenta de Avalia√ß√£o de Riscos Psicossociais
`;
      
      const blob = new Blob([reportContent], { type: 'text/plain;charset=utf-8' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `relatorio_riscos_psicossociais_${new Date().getTime()}.txt`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }

    function resetarAvaliacao() {
      // Resetar sele√ß√µes
      document.getElementById('metodologia').value = '';
      document.querySelectorAll('input[type="radio"]').forEach(input => {
        input.checked = false;
      });
      
      // Esconder elementos
      document.getElementById('version-selector').style.display = 'none';
      document.getElementById('metodologia-info').style.display = 'none';
      document.getElementById('progress-container').style.display = 'none';
      document.getElementById('dashboard').classList.remove('active');
      document.querySelectorAll('.questionario').forEach(q => {
        q.classList.remove('active');
      });
      
      // Resetar vari√°veis
      currentMethodology = '';
      currentVersion = '';
      
      // Scroll para o topo
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    // Inicializa√ß√£o
    document.addEventListener('DOMContentLoaded', function() {
      console.log('Aplica√ß√£o de Avalia√ß√£o de Riscos Psicossociais carregada com sucesso!');
    });
  </script>
</body>
</html>
